<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Connecting to a Database :: OpenShift Starter Guides</title>
    <link rel="canonical" href="http://redhat-scholars.github.io/openshift-starter-guides/rhs-openshift-starter-guides/4.8/nationalparks-java-databases.html">
    <link rel="prev" href="nationalparks-java.html">
    <link rel="next" href="nationalparks-application-health.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function () { 
      const urlParams = new URLSearchParams(window.location.search);
      const clusterName = urlParams.get('CLUSTER_SUBDOMAIN');
      const projectName = urlParams.get('PROJECT');
      if (clusterName) {
        showCluster( clusterName );
      }
      else {
        showClusterForm();
      }

      if (projectName) {
        showProject( projectName );
      } else {
        showProjectForm();
      }
    } );


    function sliceCluster(clusterName){
      if (clusterName.length > 70) {
          return "..." + clusterName.slice(35);
      } else {
          return clusterName;
      }
    }

    function showCluster( clusterName ) {
      document.getElementById('navbar-form-empty').style.display = "none";
      document.getElementById('navbar-form-filled').style.display = "flex";
      document.getElementById('cluster_subdomain').textContent = sliceCluster(clusterName);
      document.getElementById('clusterfield2').value = clusterName;

    }

    function showClusterForm( clusterName ) {
      document.getElementById('navbar-form-empty').style.display = "flex";
      document.getElementById('navbar-form-filled').style.display = "none";
    }

    function gowithcluster() {
      elClusterInput = document.getElementById('clusterfield');
      elProjectInput = document.getElementById('projectfield2');

      window.location.search = ('&CLUSTER_SUBDOMAIN=' + elClusterInput.value + '&PROJECT=' + elProjectInput.value);
    }

    function showProject( projectName ) {
      document.getElementById('navbar-form-project-empty').style.display = "none";
      document.getElementById('navbar-form-project-filled').style.display = "flex";
      document.getElementById('project').textContent = projectName;
      document.getElementById('projectfield2').value = projectName;
    }

    function showProjectForm( projectName ) {
      document.getElementById('navbar-form-project-empty').style.display = "flex";
      document.getElementById('navbar-form-project-filled').style.display = "none";
    }

    function gowithproject() {
      elProjectInput = document.getElementById('projectfield');
      elClusterInput = document.getElementById('clusterfield2');
      window.location.search = ('&CLUSTER_SUBDOMAIN=' + elClusterInput.value + '&PROJECT=' + elProjectInput.value);
    }

  </script>
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img
          src="../../_/img/header_logo.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" href="http://redhat-scholars.github.io/openshift-starter-guides">OpenShift Starter Guides</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item" id="navbar-form-empty">
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">&nbsp;<i style="color: orange;"
              class="fa fa-exclamation-triangle" aria-hidden="true"></i></span>

          <form action="javascript:void(0);" onsubmit="gowithcluster();">
            <input size="40" id="clusterfield" type="text" placeholder="Enter Cluster Subdomain">
            <input type="hidden" id="projectfield2" name="projectfield2" value="">
          </form>
        </div>

        <div class="navbar-item" id="navbar-form-filled" style="display: none;">
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">|</span>
          <span class="navbar-text" id="cluster_subdomain"></span>
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">&nbsp;<i onclick="recycle();" style="color: green;" class="fa fa-recycle" aria-hidden="true"></i></span>
        </div>

         <div class="navbar-item" id="navbar-form-project-empty">
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">&nbsp;<i style="color: orange;"
              class="fa fa-exclamation-triangle" aria-hidden="true"></i></span>

          <form action="javascript:void(0);" onsubmit="gowithproject();">
            <input size="40" id="projectfield" type="text" placeholder="Enter Project Name">
            <input type="hidden" id="clusterfield2" name="clusterfield2" value="">
          </form>
        </div>

        <div class="navbar-item" id="navbar-form-project-filled" style="display: none;">
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">|</span>
          <span class="navbar-text" id="project"></span>
          <span class="navbar-text" style="margin-left: 1rem; margin-right: 1rem;">&nbsp;<i onclick="recycle();" style="color: green;" class="fa fa-recycle" aria-hidden="true"></i></span>
        </div>

        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-scholars.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-scholars.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-scholars.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="rhs-openshift-starter-guides" data-version="4.8">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">OpenShift Starter Guides</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-workshop-summary.html">实验总览</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="prerequisites.html">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-environment.html">OpenShift 架构</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-explore.html">配置实验环境&amp;探索 OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-explore.html#the_web_console">配置实验环境&amp;Web控制台</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-explore.html#command_line_interface">Command Line Interface 命令行控制台</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="common-explore.html#download_openshift_cli">Download OpenShift CLI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-explore.html#connect_to_the_cluster_with_cli">从 CLI 连接到 OpenShift 实验环境</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="common-explore.html#working_with_proxies">Working with proxies</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="projects.html">Projects项目</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="projects.html#create_your_first_project">创建您的第一个项目</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-parksmap-architecture.html">示例程序 Parksmap 架构</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="parksmap-container-image.html">部署示例程序 Parksmap </a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-container-image.html#deploy_your_first_image">练习: 部署您的第一个镜像</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-container-image.html#containers_and_pods">背景：容器和 Pod （Containers and Pods）</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-container-image.html#examining_the_pod">练习: 查看POD信息</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-container-image.html#customizing_image_lifecycle_behavior">背景: 自定义镜像生命周期行为</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-container-image.html#services">背景: 服务 Services</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="parksmap-scaling.html">Scaling Apps缩放应用程序</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-scaling.html#deployments_and_replicasets">背景: 部署 Deployments 和 复制集 ReplicaSets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-scaling.html#exploring_deployment_related_objects">练习：探索与部署相关的对象</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-scaling.html#scaling_the_application">练习：扩展应用程序</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-scaling.html#application_self_healing">应用程序“自愈 Self Healing"</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-scaling.html#scale_down">app缩小副本</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="parksmap-routes.html">Routes （路由）</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-routes.html#routes">背景：Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-routes.html#creating_a_route">练习：创建路由</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="parksmap-logging.html">日志</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-logging.html#container_logs">背景：容器日志</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-logging.html#examining_logs">练习：探索日志</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="parksmap-permissions.html">权限</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-permissions.html#grant_serviceaccount_view_permissions">练习：授予服务帐户查看权限</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-permissions.html#redeploy_application">练习：重新部署应用程序</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="parksmap-rsh.html">连接到容器</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-rsh.html#remote_shell_session_to_container_using_cli">练习：使用 CLI 与容器进行远程 Shell 会话</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-rsh.html#execute_command_in_container">练习：使用 Web 控制台与容器进行远程 Shell 会话</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="parksmap-rsh.html#remote_shell_session_to_container_using_webconsole">练习：在容器中执行命令</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-java.html">Nationalparks Java 程序</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java.html#source_to_image">背景: 代码到镜像 Source-to-Image (S2I)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-java.html#creating_java_application">练习：创建  Java 应用程序</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="nationalparks-java.html#add_to_project">添加到项目</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="nationalparks-java.html#using_application_code_on_git_server">在 Git 服务器上使用应用程序代码</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="nationalparks-java.html#build_code_on_openshift">在 OpenShift 上构建代码</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-java-databases.html">连接到数据库</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#storage">背景：存储Storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#templates">背景：模板 Templates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#create_mongodb_template">练习：创建 MongoDB 模板</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#deploy_mongodb">练习：部署 MongoDB</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#exploring_openshift_magic">练习: Exploring OpenShift Magic</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#data_data_everywhere">练习: Data, Data, Everywhere</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#working_with_labels">练习：使用标签</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-application-health.html">应用健康检查</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-application-health.html#add_health_checks">练习：添加健康检查</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-java-codechanges-github.html">Webhooks with OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-codechanges-github.html#prerequisite_github_account">Prerequisite: GitHub Account</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-codechanges-github.html#webhooks">Webhooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-codechanges-github.html#webhooks_with_openshift">Webhooks with OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-codechanges-github.html#configuring_github_webhooks">Exercise: Configuring GitHub Web Hooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-codechanges-github.html#using_github_webhooks">Exercise: Using GitHub Web Hooks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-java-codechanges-github-actions.html">GitHub Actions with OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-codechanges-github-actions.html#disable_github_webhook">Disable GitHub Webhook</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-codechanges-github-actions.html#disable_openshift_triggers">Disable OpenShift Triggers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-codechanges-github-actions.html#configure_github_action">Configure GitHub Action</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-codechanges-github-actions.html#add_github_action">Add GitHub Action</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-codechanges-github-actions.html#enable_openshift_triggers">Enable OpenShift Triggers</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-java-pipeline.html">Continuous Integration and Pipelines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline.html#install_openshift_pipelines_from_operatorhub">Install OpenShift Pipelines from OperatorHub</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline.html#understanding_tekton">Understanding Tekton</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline.html#create_your_pipeline">Create Your Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline.html#run_the_pipeline">Run the Pipeline</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html">Webhooks with Pipelines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html#prerequisite_github_account">Prerequisite: GitHub Account</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html#webhooks">Web Hooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html#adding_triggers_to_your_pipeline">Adding Triggers to your Pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html#configuring_github_webhooks">Exercise: Configuring GitHub Web Hooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nationalparks-java-pipeline-codechanges-github.html#using_github_webhooks">Exercise: Using GitHub Web Hooks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="mlbparks-templates.html">MLBParks App</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-templates.html#instantiate_template">Exercise: Instantiate a Template</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="mlbparks-binary-build.html">Binary Builds</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-binary-build.html#moving_on_from_s2i">Moving on From S2I</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-binary-build.html#fast_iterative_code_change_using_binary_deploy">Fast Iterative Code Change Using Binary Deploy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="mlbparks-binary-build.html#using_binary_deployment">Exercise: Using Binary Deployment</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mlbparks-binary-build.html#clone_source">Clone source</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mlbparks-binary-build.html#setup_the_build_of_the_war_file">Setup the Build of the WAR file</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mlbparks-binary-build.html#clone_change">Clone change</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mlbparks-binary-build.html#doing_the_binary_build">Doing the Binary Build</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="mlbparks-debugging.html">Debugging Apps</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-debugging.html#port_forwading_and_debugging">Background: Port Forwarding and Debugging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-debugging.html#enabling_debugging_in_eap_on_openshift">Exercise: Enabling Debugging in EAP on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-debugging.html#port-forwarding_from_svc_to_our_local_machine">Exercise: Port-Forwarding from a Service to our local machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-debugging.html#setting_up_remote_debugging">Attaching a Remote Debugger</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mlbparks-debugging.html#port-forwarding_from_pod_to_our_local_machine">Exercise: Port-Forwarding from the pod to our local machine</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="common-further-resources.html">Further Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="common-workshop-links.html">Workshop Links</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-workshop-links.html#openshift_cluster_url">OpenShift Cluster URL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-workshop-links.html#workshop_guides">Workshop Guides</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-workshop-links.html#web_terminal">Web terminal</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="common-workshop-links.html#git_server">Git Server</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">OpenShift Starter Guides</span>
    <span class="version">4.8</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">OpenShift Starter Guides</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">4.8</a>
        </li>
        <li class="version">
          <a href="../4.7/index.html">4.7</a>
        </li>
        <li class="version">
          <a href="../4.6/index.html">4.6</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">OpenShift Starter Guides</a></li>
    <li><a href="nationalparks-java-databases.html">连接到数据库</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">4.8</button>
  <div class="version-menu">
    <a class="version is-current" href="nationalparks-java-databases.html">4.8</a>
    <a class="version" href="../4.7/nationalparks-java-databases.html">4.7</a>
    <a class="version" href="../4.6/nationalparks-java-databases.html">4.6</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/wangmt2000/openshift-starter-guides/edit/ocp-4.8/documentation/modules/ROOT/pages/nationalparks-java-databases.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Connecting to a Database</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>在本节中，我们将部署和连接 MongoDB 数据库，nationalparks应用程序将在其中存储位置信息。</p>
</div>
<div class="paragraph">
<p>最后，我们将 <code>nationalparks</code> 应用程序标记为地图可视化工具的后端，以便 `parksmap`组件可以使用 OpenShift 发现机制对其进行动态发现，并自动显示地图。</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/roadshow-app-architecture-nationalparks-2.png" alt="Application architecture" width="800">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="storage"><a class="anchor" href="#storage"></a>Background: Storage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>大多数应用程序在某种程度上是“有状态的”或“动态的”，这通常是通过数据库或其他数据存储来实现的。在本实验中，我们将把 MongoDB 添加到我们的nationalparks应用程序中，然后重新连接它以通过 secret 使用环境变量与数据库通信。</p>
</div>
<div class="paragraph">
<p>我们将使用 OpenShift 附带的 MongoDB 映像。</p>
</div>
<div class="paragraph">
<p>默认情况下，使用 EmptyDir 进行数据存储，这意味着如果Pod 消失，数据也会消失。在实际应用程序中，您将使用 OpenShift 的持久性存储机制将存储（NFS、Ceph、EBS、iSCSI 等）附加到Pod，从而为它们提供一个持久的位置来存储其数据。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="templates"><a class="anchor" href="#templates"></a>Background: Templates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在本模块中，我们将从模板 Template 创建 MongoDB ，这是 OpenShift 中用于为某些值定义参数的有用方法，例如数据库用户名或密码，这些值可以由 OpenShift 在处理时自动生成。</p>
</div>
<div class="paragraph">
<p>管理员可以将模板加载到 OpenShift 中并使所有用户都可以使用它们。用户可以创建模板并将其加载到自己的项目中，以供其他用户（具有访问权限）共享和使用。</p>
</div>
<div class="paragraph">
<p>模板重要意义在于，他们可以通过提供一个可以用一条命令部署“配置参数”，加快应用开发的部署流程。不仅如此，它们还可以从外部 URL 加载到 OpenShift 中，这将允许您将模板保存在版本控制系统中。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create_mongodb_template"><a class="anchor" href="#create_mongodb_template"></a>Exercise: Create a MongoDB Template 因为我们使用了developer-sandbox，请跳到部署 MongoDB</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are using <a href="https://developers.redhat.com/developer-sandbox" target="_blank" rel="noopener">Developer Sandbox for Red Hat OpenShift</a>, you can <strong>skip</strong> this section and jump to the next one called <strong>Exercise: Deploy MongoDB</strong> because MongoDB Template it&#8217;s already available on Developer Sandbox.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this step we will create a MongoDB template inside our project, so that is only visible to our user and we can access it from Developer Perspective to create a MongoDB instance.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc create -f https://raw.githubusercontent.com/openshift-labs/starter-guides/ocp-4.6/mongodb-template.yaml -n %PROJECT%</code></pre>
</div>
</div>
<div class="paragraph">
<p>What just happened? What did you just <code>create</code>? The item that we passed to the <code>create</code>
command is a <strong>Template</strong>. <code>create</code> simply makes the template available in
your <strong>Project</strong>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploy_mongodb"><a class="anchor" href="#deploy_mongodb"></a>练习: 部署 MongoDB</h2>
<div class="sectionbody">
<div class="paragraph">
<p>正如您目前所见，Web 控制台可以非常轻松地将应用部署到 OpenShift。当我们部署数据库时，我们传入一些值进行配置。这些值用于设置数据库的用户名、密码和名称。</p>
</div>
<div class="paragraph">
<p>数据库映像的构建方式将使用提供的信息自动配置自己（假设持久存储中没有数据！）。该镜像将确保：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>存在具有指定名称的数据库</p>
</li>
<li>
<p>存在具有指定名称的用户</p>
</li>
<li>
<p>用户可以使用指定的密码访问指定的数据库</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>在workshop项目的开发者视图中，单击+Add然后单击Database。在数据库视图中，您可以单击Mongo以仅过滤 MongoDB。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
确保不要在 类型 <strong>Type</strong> 部分选中 Operator 支持的 ( <strong>Operator Backed</strong>  )选项
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/nationalparks-databases-catalog-databases.png" alt="Data Stores">
</div>
</div>
<div class="paragraph">
<p>或者，您可以mongodb在搜索框中键入。深入查看 MongoDB 后，找到MongoDB (Ephemeral)模板并选择它。您会注意到有多个 MongoDB 模板可用。我们不需要具有持久存储的数据库，因此您应该选择临时 Mongo 模板。继续并选择临时模板，然后单击实例化模板按钮。</p>
</div>
<div class="paragraph">
<p>当我们执行应用程序构建时，没有模板。相反，我们直接选择了构建器映像，而 OpenShift 仅展示了标准构建工作流程。现在我们正在使用模板 - 一组预配置的资源，其中包括可以自定义的参数。在我们的例子中，我们关心的参数是——用户、密码、数据库和管理员密码。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/nationalparks-databases-catalog-databases-mongodb-config.png" alt="MongoDB Deploy">
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
确保您将数据库服务命名为 <strong>mongodb-nationalparks</strong>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>您可以看到某些字段显示“如果为空则生成”。这是OpenShift中模板的一个功能。现在，请确保在各自的字段中使用以下值：</p>
</div>
<div class="paragraph">
<p><strong>Database Service Name</strong>:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>mongodb-nationalparks</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>MongoDB Connection Username</strong>:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>mongodb</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>MongoDB Connection Password</strong>:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>mongodb</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>MongoDB Database Name</strong>:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>mongodb</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>MongoDB Admin Password</strong>:</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>mongodb</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
确保已MongoDB Database Name使用适当的值配置参数，因为它的默认值为sampledb.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>输入上述信息后，单击“创建”进入下一步，这将允许我们添加绑定。</p>
</div>
<div class="paragraph">
<p>从左侧菜单中，单击 <strong>Secrets</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/nationalparks-databases-list-secrets.png" alt="List Secrets">
</div>
</div>
<div class="paragraph">
<p>单击我们将用于Parameters 的列出的机密名称。该机密可用于其他组件（例如nationalparks后端）以对数据库进行身份验证。</p>
</div>
<div class="paragraph">
<p>现在连接和身份验证信息存储在我们项目中的 <strong>Secrets</strong>.中，我们需要将其添加到nationalparks后端。单击将 <strong>Secrets</strong> 添加到工作负载按钮。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/nationalparks-databases-binding-view-secret.png" alt="National Parks Binding">
</div>
</div>
<div class="paragraph">
<p>选择nationalparks工作负载并单击保存。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/nationalparks-databases-binding-add-binding-to-nationalparks.png" alt="Add binding to application">
</div>
</div>
<div class="paragraph">
<p>这种配置更改将触发nationalparks应用程序的新部署，并正确注入环境变量。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>返回拓扑视图，如果您的 <code>mongodb-nationalparks</code> 组件不在表示workshop应用程序的浅灰色区域中，请在按住<kbd>Shift</kbd> 的同时单击并拖动组件以将其与其他两个组件一起添加到组中（如下所示）</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/nationalparks-databases-add-mongodb-to-workshop-app.png" alt="Add mongodb to the workshop app">
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>接下来，让我们修复分配给 <code>mongodb-nationalparks</code> 部署的标签。目前，我们无法在使用目录中的数据库模板时设置标签，因此我们将手动修复这些标签。</p>
</div>
<div class="paragraph">
<p>和以前一样，我们将添加 3 个标签：</p>
</div>
<div class="paragraph">
<p>应用组名称：</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>app=workshop</code></pre>
</div>
</div>
<div class="paragraph">
<p>接下来是此部署的名称。</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>component=nationalparks</code></pre>
</div>
</div>
<div class="paragraph">
<p>最后，这个组件在整个应用程序中扮演的角色。</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>role=database</code></pre>
</div>
</div>
<div class="paragraph">
<p>执行以下命令：</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc label dc/mongodb-nationalparks svc/mongodb-nationalparks app=workshop component=nationalparks role=database --overwrite</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exploring_openshift_magic"><a class="anchor" href="#exploring_openshift_magic"></a>Exercise: Exploring OpenShift Magic</h2>
<div class="sectionbody">
<div class="paragraph">
<p>一旦我们将 Secret 附加到Deployment，一些神奇的事情就发生了。OpenShift 认为这是一个足够重要的更改，可以保证更新ReplicaSet的内部版本号。您可以通过查看以下输出来验证这一点oc get rs：</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                       DESIRED   CURRENT   READY   AGE
nationalparks-58bd4758fc   0         0         0       4m58s
nationalparks-7445576cd9   0         0         0       6m42s
nationalparks-789c6bc4f4   1         1         1       41s
parksmap-57df75c46d        1         1         1       8m24s
parksmap-65c4f8b676        0         0         0       18m</code></pre>
</div>
</div>
<div class="paragraph">
<p>我们看到当前部署的 DESIRED 和 CURRENT 实例数。其他实例的期望和当前数量为 0。这意味着 OpenShift 优雅地拆除了我们的“旧”应用程序并建立了一个“新”实例。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data_data_everywhere"><a class="anchor" href="#data_data_everywhere"></a>练习: Data, Data, Everywhere</h2>
<div class="sectionbody">
<div class="paragraph">
<p>现在我们已经部署了一个数据库，我们可以再次访问nationalparksWeb 服务来查询数据：</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>https://nationalparks-%PROJECT%.%CLUSTER_SUBDOMAIN%/ws/data/all</code></pre>
</div>
</div>
<div class="paragraph">
<p>结果呢？</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">[]</code></pre>
</div>
</div>
<div class="paragraph">
<p>数据在哪里？想想你经历的过程。您部署了应用程序，然后部署了数据库。但没有什么实际加载任何数据导入数据库。</p>
</div>
<div class="paragraph">
<p>该应用程序提供了一个端点来做到这一点：</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>https://nationalparks-%PROJECT%.%CLUSTER_SUBDOMAIN%/ws/data/load</code></pre>
</div>
</div>
<div class="paragraph">
<p>结果呢？</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Items inserted in database: 2893</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果你再回到 <code>/ws/data/all</code> 你现在会看到大量的 JSON 数据。那太棒了。我们的公园地图应该终于有用了！</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Firefox 54 等浏览器报告了一些错误，无法正确解析生成的 JSON。这是浏览器问题，应用程序运行正常。
</td>
</tr>
</table>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>https://parksmap-%PROJECT%.%CLUSTER_SUBDOMAIN%</code></pre>
</div>
</div>
<div class="paragraph">
<p>嗯&#8230;&#8203;&#8230;&#8203;只有一件事。主地图仍然没有显示公园。这是因为前端公园地图仅尝试与具有正确 *Label*的服务对话。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>您可能想知道数据库连接是如何神奇地开始工作的？将应用程序部署到 OpenShift 时，最好使用环境变量variables、机密secrets或映射configMap 来定义与相关系统的连接。这允许跨不同环境的应用程序可移植性。可以在此处查看执行连接以及创建数据库架构的源文件：</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>http://www.github.com/openshift-roadshow/nationalparks/blob/master/src/main/java/com/openshift/evg/roadshow/parks/db/MongoDBConnection.java#L44-l48</code></pre>
</div>
</div>
<div class="paragraph">
<p>简而言之：通过引用连接到服务（如数据库）的绑定，在 OpenShift 上的不同生命周期环境中推广应用程序可能很简单，而无需修改应用程序代码。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="working_with_labels"><a class="anchor" href="#working_with_labels"></a>练习: Working With Labels</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在之前的关于Services和Routes和Selectors实验中，我们知道标签 <strong>Label</strong> 只是一个键值对 key=value pair。一般来说，标签 <strong>Label</strong> 只是一个任意的键值对。这个可以是任何东西。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pizza=pepperoni</code></p>
</li>
<li>
<p><code>pet=dog</code></p>
</li>
<li>
<p><code>openshift=awesome</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>在parks map这个项目中，应用程序实际上是在查询 OpenShift API 并询问项目中的 <strong>Routes</strong> 和 <strong>Services</strong> 。如果它们中的任何一个具有 `type=parksmap-backend`的标签 <strong>Label</strong> ，应用程序知道询问 endpoints 以查找地图数据。您可以在<a href="https://github.com/openshift-roadshow/parksmap-web/blob/master/src/main/java/com/openshift/evg/roadshow/rest/RouteWatcher.java#L20">此处</a>查看执行此操作的代码 。</p>
</div>
<div class="paragraph">
<p>幸运的是，命令行为我们提供了一种方便的方式来操作标签。<code>describe</code>  <code>nationalparks</code>  服务：</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc describe route nationalparks</code></pre>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Name:                   nationalparks
Namespace:              %PROJECT%
Created:                2 hours ago
Labels:                 app=workshop
                        app.kubernetes.io/component=nationalparks
                        app.kubernetes.io/instance=nationalparks
                        app.kubernetes.io/name=java
                        app.kubernetes.io/part-of=workshop
                        app.openshift.io/runtime=java
                        app.openshift.io/runtime-version=11
                        component=nationalparks
                        role=backend
Annotations:            openshift.io/host.generated=true
Requested Host:         nationalparks-%PROJECT%.%CLUSTER_SUBDOMAIN%
                        exposed on router router 2 hours ago
Path:                   &lt;none&gt;
TLS Termination:        &lt;none&gt;
Insecure Policy:        &lt;none&gt;
Endpoint Port:          8080-tcp

Service:                nationalparks
Weight:                 100 (100%)
Endpoints:              10.1.9.8:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>你会看到它已经有了一些标签。现在，使用oc label：</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc label route nationalparks type=parksmap-backend</code></pre>
</div>
</div>
<div class="paragraph">
<p>你会看到类似的东西：</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">route.route.openshift.io/nationalparks labeled</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果您现在检查浏览器：</p>
</div>
<div class="listingblock copypaste">
<div class="content">
<pre class="highlightjs highlight"><code>https://parksmap-%PROJECT%.%CLUSTER_SUBDOMAIN%/</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/nationalparks-databases-new-parks.png" alt="MongoDB">
</div>
</div>
<div class="paragraph">
<p>你会注意到公园突然出现了。这太酷了！</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="nationalparks-java.html" class="query-params-link">Nationalparks Java 程序</a></span>
  <span class="next"><a href="nationalparks-application-health.html" class="query-params-link">应用健康检查</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../../_/js/vendor/clipboard.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
